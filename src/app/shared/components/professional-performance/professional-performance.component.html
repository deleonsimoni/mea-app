<div class="performance">
  <div class="row">
    <div class="col-lg-12">
      <div class="row">
        <div class="col-lg-11">
          <input
            type="text"
            class="performance__institution"
            placeholder="Nome da instituição"
            [(ngModel)]="institution"
          />
        </div>
        <div class="col-lg-1" (click)="deletePerformance()">
          <button class="action action--delete action--full">
            <i class="fas fa-times-circle action__icon"></i>
          </button>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-6">
          <div class="flex-align mt-3">
            <p class="performance__title performance--spotlight">
              Vinculo institucional
            </p>
            <button class="btn" (click)="addJobControl()">
              Adicionar +
            </button>
          </div>

          <form [formGroup]="performancesForm">
            <ng-container formArrayName="jobs">
              <div
                *ngFor="
                  let job of performancesForm.get('jobs')['controls'];
                  let jobIndex = index
                "
                [formGroupName]="jobIndex"
              >
                <div class="row mt-4">
                  <div class="col-lg-2">
                    <input
                      type="text"
                      class="performance__input-text performance--spotlight"
                      placeholder="Data inicial"
                      formControlName="initialDate"
                    />
                  </div>
                  <div class="col-lg-2">
                    <input
                      type="text"
                      class="performance__input-text performance--spotlight"
                      placeholder="Data final"
                      formControlName="finalDate"
                    />
                  </div>
                  <div
                    [ngClass]="{
                      'col-lg-7': jobIndex > 0,
                      'col-lg-8': jobIndex == 0
                    }"
                  >
                    <input
                      type="text"
                      class="performance__input-text"
                      placeholder="Ocupação"
                      formControlName="occupation"
                    />
                  </div>
                  <div
                    class="col-lg-1 no-padding"
                    (click)="deleteJob(jobIndex)"
                    *ngIf="jobIndex > 0"
                  >
                    <button class="action action--delete">
                      <i class="fas fa-times-circle action__icon"></i>
                    </button>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="performance__content">
                      <textarea
                        name=""
                        class="performance__text-box"
                        placeholder="Descrição"
                        formControlName="description"
                        cols="30"
                        rows="10"
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <p
                      *ngIf="getError(jobIndex, 'jobs')"
                      class="performance__error"
                    >
                      Preencha todos os campos, ou exclua o item!
                    </p>
                  </div>
                </div>
              </div>
            </ng-container>
          </form>
        </div>
        <div class="col-lg-6">
          <div class="flex-align mt-3">
            <p class="performance__title performance--spotlight">Atividades</p>
            <button class="btn" (click)="addActivityControl()">
              Adicionar +
            </button>
          </div>

          <form [formGroup]="performancesForm">
            <ng-container formArrayName="activities">
              <div
                *ngFor="
                  let activity of performancesForm.get('activities')[
                    'controls'
                  ];
                  let activityIndex = index
                "
                [formGroupName]="activityIndex"
              >
                <div class="row mt-4">
                  <div class="col-lg-3">
                    <input
                      type="text"
                      class="performance__input-text performance--spotlight"
                      placeholder="Data inicial"
                      formControlName="initialDate"
                    />
                  </div>
                  <div
                    [ngClass]="{
                      'col-lg-8': activityIndex > 0,
                      'col-lg-9': activityIndex == 0
                    }"
                  >
                    <input
                      type="text"
                      class="performance__input-text"
                      placeholder="Ocupação"
                      formControlName="role"
                    />
                  </div>
                  <div
                    class="col-lg-1 no-padding"
                    (click)="deleteActivity(activityIndex)"
                    *ngIf="activityIndex > 0"
                  >
                    <button class="action action--delete">
                      <i class="fas fa-times-circle action__icon"></i>
                    </button>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="performance__content">
                      <textarea
                        name=""
                        class="performance__text-box"
                        placeholder="Descrição"
                        formControlName="description"
                        cols="30"
                        rows="3"
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <p
                      *ngIf="getError(activityIndex, 'activities')"
                      class="performance__error"
                    >
                      Preencha todos os campos, ou exclua o item!
                    </p>
                  </div>
                </div>
              </div>
            </ng-container>
          </form>
        </div>
      </div>

      <div class="row justify-content-center" *ngIf="showSaveButton">
        <div class="col-lg-4 mt-3">
          <button class="btn btn--full" (click)="savePerformance()">
            Salvar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
